{"version":3,"file":"dashboard.min.js","sources":["../src/dashboard.js"],"sourcesContent":["// This file is part of Moodle: https://moodle.org/\n// @module block_category_courses/dashboard\n\n/**\n * Maneja el clic (o enter/espacio) en la tarjeta de categoría.\n * Envía el categoryid por POST hacia view_courses.php\n * @param {Event} e - El evento de clic o teclado\n */\nfunction handleCardClick(e) {\n    // No navegar si se hace clic en un elemento interactivo interno\n    if (e.target.closest('a, button, input, select, textarea')) {\n        return;\n    }\n\n    const card = this;\n    const categoryId = card.dataset.categoryId;\n    const clickBehavior = card.dataset.clickBehavior || 'category';\n    const linkElement = card.querySelector('.card-link');\n    const url = linkElement ? linkElement.dataset.url : null;\n\n    if (clickBehavior === 'courses') {\n        e.preventDefault();\n\n        // --- Crear formulario invisible para POST ---\n        const form = document.createElement('form');\n        form.method = 'POST';\n        form.action = M.cfg.wwwroot + '/blocks/category_courses/view_courses.php';\n\n        const cat = document.createElement('input');\n        cat.type = 'hidden';\n        cat.name = 'categoryid';\n        cat.value = categoryId;\n        form.appendChild(cat);\n\n        // Opcional: añadir sesskey si tu página valida tokens\n        // const sk = document.createElement('input');\n        // sk.type = 'hidden';\n        // sk.name = 'sesskey';\n        // sk.value = M.cfg.sesskey;\n        // form.appendChild(sk);\n\n        document.body.appendChild(form);\n        form.submit();\n        return;\n    }\n\n    // Comportamiento normal (navegación con URL)\n    if (url) {\n        e.preventDefault();\n        card.classList.add('card-clicked');\n        setTimeout(() => {\n            window.location.href = url;\n        }, 150);\n    }\n}\n\n/**\n * Inicializa la funcionalidad de tarjetas de categorías.\n */\nexport const init = () => {\n    const cards = document.querySelectorAll('.category-card');\n\n    cards.forEach((card) => {\n        // Accesibilidad\n        card.setAttribute('role', 'button');\n        card.setAttribute('tabindex', '0');\n\n        // Click handler\n        card.addEventListener('click', handleCardClick);\n\n        // Teclado (Enter o espacio)\n        card.addEventListener('keydown', (e) => {\n            if (e.key === 'Enter' || e.key === ' ') {\n                e.preventDefault();\n                handleCardClick.call(card, e);\n            }\n        });\n    });\n};\n"],"names":["handleCardClick","e","target","closest","card","this","categoryId","dataset","clickBehavior","linkElement","querySelector","url","preventDefault","form","document","createElement","method","action","M","cfg","wwwroot","cat","type","name","value","appendChild","body","submit","classList","add","setTimeout","window","location","href","querySelectorAll","forEach","setAttribute","addEventListener","key","call"],"mappings":"mFAQSA,gBAAgBC,MAEjBA,EAAEC,OAAOC,QAAQ,mDAIfC,KAAOC,KACPC,WAAaF,KAAKG,QAAQD,WAC1BE,cAAgBJ,KAAKG,QAAQC,eAAiB,WAC9CC,YAAcL,KAAKM,cAAc,cACjCC,IAAMF,YAAcA,YAAYF,QAAQI,IAAM,QAE9B,YAAlBH,cAA6B,CAC7BP,EAAEW,uBAGIC,KAAOC,SAASC,cAAc,QACpCF,KAAKG,OAAS,OACdH,KAAKI,OAASC,EAAEC,IAAIC,QAAU,kDAExBC,IAAMP,SAASC,cAAc,gBACnCM,IAAIC,KAAO,SACXD,IAAIE,KAAO,aACXF,IAAIG,MAAQlB,WACZO,KAAKY,YAAYJ,KASjBP,SAASY,KAAKD,YAAYZ,WAC1BA,KAAKc,SAKLhB,MACAV,EAAEW,iBACFR,KAAKwB,UAAUC,IAAI,gBACnBC,YAAW,KACPC,OAAOC,SAASC,KAAOtB,MACxB,iGAOS,KACFG,SAASoB,iBAAiB,kBAElCC,SAAS/B,OAEXA,KAAKgC,aAAa,OAAQ,UAC1BhC,KAAKgC,aAAa,WAAY,KAG9BhC,KAAKiC,iBAAiB,QAASrC,iBAG/BI,KAAKiC,iBAAiB,WAAYpC,IAChB,UAAVA,EAAEqC,KAA6B,MAAVrC,EAAEqC,MACvBrC,EAAEW,iBACFZ,gBAAgBuC,KAAKnC,KAAMH"}